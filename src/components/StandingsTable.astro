---
interface Props {
  standings: Array<{
    pos: number;
    team: string;
    played: number;
    won: number;
    lost: number;
    points_for: number;
    points_against: number;
    difference: number;
    total_points: number;
  }>;
  category: 'masculino' | 'femenino';
  phase: string;
  logos?: Record<string, string>;
}

const { standings, category, phase, logos = {} } = Astro.props;
import TeamBadge from './TeamBadge.astro';
const accentColor = category === 'masculino' ? 'text-masculino' : 'text-femenino';
const bgColor = category === 'masculino' ? 'bg-masculino' : 'bg-femenino';
---

<div class="bg-white rounded-2xl shadow-xl overflow-hidden">
  <div class={`${bgColor} text-white p-4`}>
    <h3 class="text-xl font-bold flex items-center space-x-2">
      <span>üèÜ</span>
      <span>Tabla de Posiciones</span>
    </h3>
  </div>
  
  <div class="overflow-x-auto">
    <table class="w-full">
      <thead class="bg-gray-50">
        <tr class="text-sm font-semibold text-gray-700">
          <th class="px-4 py-3 text-left">Pos</th>
          <th class="px-4 py-3 text-left">Equipo</th>
          <th class="px-4 py-3 text-center">PJ</th>
          <th class="px-4 py-3 text-center">PG</th>
          <th class="px-4 py-3 text-center">PP</th>
          <th class="px-4 py-3 text-center">PF</th>
          <th class="px-4 py-3 text-center">PC</th>
          <th class="px-4 py-3 text-center">DIF</th>
          <th class="px-4 py-3 text-center">PTS</th>
        </tr>
      </thead>
      <tbody>
        {standings.map((team, index) => (
          <tr class={`border-b hover:bg-gray-50 transition-colors ${index < 3 ? 'bg-green-50' : ''}`}>
            <td class="px-4 py-3">
              <div class="flex items-center space-x-2">
                <span class={`font-bold ${index === 0 ? accentColor : 'text-gray-700'}`}>
                  {team.pos}
                </span>
                {index === 0 && <span class="text-yellow-500">üëë</span>}
                {index === 1 && <span class="text-gray-400">ü•à</span>}
                {index === 2 && <span class="text-orange-600">ü•â</span>}
              </div>
            </td>
            <td class="px-4 py-3">
              {
                (() => {
                  const parts = String(team.team).split(' - ').map(s => s.trim());
                  const name = parts[0] ?? team.team;
                  const city = parts[1] ?? '';
                  const img = logos[name] ?? logos[team.team] ?? undefined;
                  return (
                    <div class="flex items-center">
                      <TeamBadge name={name} city={city} img={img} size="sm" />
                    </div>
                  );
                })()
              }
            </td>
            <td class="px-4 py-3 text-center font-medium">{team.played}</td>
            <td class="px-4 py-3 text-center font-medium text-green-600">{team.won}</td>
            <td class="px-4 py-3 text-center font-medium text-red-600">{team.lost}</td>
            <td class="px-4 py-3 text-center font-medium">{team.points_for}</td>
            <td class="px-4 py-3 text-center font-medium">{team.points_against}</td>
            <td class="px-4 py-3 text-center">
              <span class={`font-bold ${team.difference > 0 ? 'text-green-600' : team.difference < 0 ? 'text-red-600' : 'text-gray-600'}`}>
                {team.difference > 0 ? '+' : ''}{team.difference}
              </span>
            </td>
            <td class="px-4 py-3 text-center">
              <span class={`font-bold text-lg ${accentColor}`}>{team.total_points}</span>
            </td>
          </tr>
        ))}
      </tbody>
    </table>
  </div>
  
  <div class="bg-gray-50 px-4 py-3 text-xs text-gray-600">
    <p><strong>PJ:</strong> Partidos Jugados | <strong>PG:</strong> Partidos Ganados | <strong>PP:</strong> Partidos Perdidos</p>
    <p><strong>PF/PC:</strong> Puntos a Favor/Contra | <strong>DIF:</strong> Diferencia | <strong>PTS:</strong> Puntos Totales</p>
  </div>
</div>