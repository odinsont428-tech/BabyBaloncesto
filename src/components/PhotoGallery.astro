---
interface Props {
  phase: string;
  category: 'masculino' | 'femenino';
  id: string;
  images?: Array<any>;
}

const { phase, category, id, images = undefined } = Astro.props as Props;
const accentColor = category === 'masculino' ? 'text-masculino' : 'text-femenino';

// Prefer images passed from the page (per-phase); otherwise show no gallery images and a friendly message
const galleryPhotos = Array.isArray(images) ? images : [];
---

<div class="space-y-4">
  <h3 class={`font-bold text-xl ${accentColor} flex items-center space-x-2`}>
    <span>ðŸ“¸</span>
    <span>GalerÃ­a - {phase}</span>
  </h3>
  
  <!-- galleryPhotos already computed in frontmatter -->

  <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4" id={`gallery-${id}`}>
    {
      galleryPhotos && galleryPhotos.length > 0 ? galleryPhotos.map((photo: any, index: number) => (
      <a
        href={(typeof photo === 'string' ? photo : (photo.src || photo.thumbnail))}
        data-pswp-width={(typeof photo === 'object' ? (photo.width || 1200) : 1200)}
        data-pswp-height={(typeof photo === 'object' ? (photo.height || 800) : 800)}
        class="block aspect-square overflow-hidden rounded-xl hover:scale-105 transition-transform duration-300 shadow-lg hover:shadow-xl"
      >
        <img
          src={(typeof photo === 'object' ? (photo.thumbnail || photo.src) : photo)}
          alt={(typeof photo === 'object' ? (photo.alt || `${phase} - Foto ${index + 1}`) : `${phase} - Foto ${index + 1}`)}
          class="w-full h-full object-cover"
          loading="lazy"
        />
      </a>
    )) : (
      <div class="col-span-2 md:col-span-3 lg:col-span-4 text-center py-8">
        <div class="bg-light-gray rounded-xl p-6 border border-dashed border-gray-300 inline-block">
          <p class="text-gray-600">No hay fotos disponibles para esta fase.</p>
        </div>
      </div>
    )
    }
  </div> 
</div>

<script define:vars={{ id }}>
  document.addEventListener('DOMContentLoaded', function() {
    if (typeof PhotoSwipeLightbox !== 'undefined') {
      const lightbox = new PhotoSwipeLightbox({
        gallery: `#gallery-${id}`,
        children: 'a',
        pswpModule: PhotoSwipe
      });
      lightbox.init();
    }
  });
</script>



